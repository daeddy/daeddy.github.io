(()=>{"use strict";var t,e={167:(t,e)=>{e.__esModule=!0;var i={red:255,green:0,blue:0},s=function(){function t(t,e,s,h){this.x=0,this.y=0,this.width=50,this.height=10,this.color=i,this.x=t,this.y=e,this.width=s,this.height=h}return t.prototype.hitTestPoint=function(t,e){return t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height},t}();e.default=s},746:(t,e,i)=>{e.__esModule=!0;var s=i(509),h=i(409),n=function(){function t(t,e){this._width=t,this._height=e,this._count=t*e,this.values=new Array(t*e);for(var i=(0,h.getRainbowColors)(this._width),n=0;n<this._width;n++)for(var a=0;a<this._height;a++){var r=new s.default(n,a,i[n]);this.values[n+a*this._width]=r}}return t.prototype.count=function(){return this._count},t.prototype.width=function(){return this._width},t.prototype.height=function(){return this._height},t.prototype.getParticle=function(t,e){var i=t+e*this._width;if(!(i>=this.values.length||i<0))return this.values[t+e*this._width]},t.prototype.removeParticle=function(t,e){var i=this.values[t+e*this._width];return i&&(this._count--,this.values[t+e*this._width]=void 0),i},t}();e.default=n},836:(t,e)=>{e.__esModule=!0;var i=function(){function t(t){this._canvas=t,this._canvasCtx=this._canvas.getContext("2d"),this.clear()}return t.prototype.renderBar=function(t){this._canvasCtx.beginPath(),this._canvasCtx.fillStyle="rgb(".concat(t.color.red,",").concat(t.color.green,",").concat(t.color.blue,")"),this._canvasCtx.fillRect(t.x,t.y,t.width,t.height),this._canvasCtx.stroke()},t.prototype.clear=function(){this._canvasCtx.clearRect(0,0,this._canvas.width,this._canvas.height),this._imgData=this._canvasCtx.getImageData(0,0,this._canvas.width,this._canvas.height),this._pixels=this._imgData.data},t.prototype.render=function(){this._canvasCtx.putImageData(this._imgData,0,0)},t.prototype.setPixel=function(t,e,i){var s=e*(4*this._imgData.width)+4*t;this._pixels[s]=i.red,this._pixels[s+1]=i.green,this._pixels[s+2]=i.blue,this._pixels[s+3]=255},t.prototype.offsetLeft=function(){return this._canvas.offsetLeft},t}();e.default=i},509:(t,e,i)=>{e.__esModule=!0;var s=i(409),h=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),this.xSpeed=0,this.ySpeed=0,this.color=s.DEFAULT_COLOR,this.x=t,this.y=e,this.color=i}return t.prototype.invertXDirection=function(){this.xSpeed=-this.xSpeed},t.prototype.invertYDirection=function(){this.ySpeed=-this.ySpeed},t.prototype.X=function(){return Math.round(this.x)},t.prototype.Y=function(){return Math.round(this.y)},t.prototype.speed=function(){return Math.sqrt(this.xSpeed*this.xSpeed+this.xSpeed*this.xSpeed)},t.prototype.radian=function(){return Math.atan2(this.ySpeed,this.xSpeed)},t}();e.default=h},740:(t,e,i)=>{e.__esModule=!0,e.GameCanvas=e.Particle=e.Blocks=e.Bar=void 0;var s=i(167);e.Bar=s.default;var h=i(746);e.Blocks=h.default;var n=i(509);e.Particle=n.default;var a=i(836);e.GameCanvas=a.default},989:(t,e,i)=>{e.__esModule=!0;var s=i(740),h=i(409),n=function(){function t(t,e,i,h){this._fps=30,this._width=i,this._height=h,this._canvas=new s.GameCanvas(e),t.addEventListener("mousemove",this._mousemove.bind(this),!1),t.addEventListener("touchmove",this._touchmove.bind(this),!1)}return t.prototype._handleWin=function(){alert("Done!\n"),this.init()},t.prototype._handleLose=function(){alert("Try again"),this.init()},t.prototype._update=function(){var t=this;if(this._now=Date.now(),this._elapsed=this._now-this._then,this._canvas){if(this._elapsed>this._fpsInterval){this._then=this._now-this._elapsed%this._fpsInterval,this._canvas.clear(),this._blocks.values.forEach((function(e){e&&t._canvas.setPixel(e.x,e.y,e.color)}));var e=new Array;this._balls.forEach((function(i){for(var s=i.speed(),h=i.radian(),n=0;n<s;n++){i.x+=i.xSpeed/s,i.y+=i.ySpeed/s;var a=t._blocks.getParticle(i.X(),i.Y());if(a){var r=t._blocks.removeParticle(i.X(),i.Y());r&&(r.xSpeed=3*Math.cos(h+2*Math.PI/(30*Math.random())-15),r.ySpeed=1,r.color=a.color,t._fallBlocks.push(r)),i.invertYDirection()}(i.x<0&&i.xSpeed<0||i.x>t._width&&i.xSpeed>0)&&i.invertXDirection(),i.y<0&&i.ySpeed<0&&i.invertYDirection(),(i.y>t._height||i.y<0)&&e.push(i),t._bar.hitTestPoint(i.x,i.y)&&(i.ySpeed=-Math.abs(i.ySpeed)),t._canvas.setPixel(i.X(),i.Y(),i.color)}})),e.forEach((function(e){var i=t._balls.indexOf(e);-1!=i&&t._balls.splice(i,1)}));var i=new Array;this._fallBlocks.forEach((function(e){if(e.ySpeed+=.1,e.x+=e.xSpeed,e.x<0&&(e.x+=t._width),e.y+=e.ySpeed,t._canvas.setPixel(e.X(),e.Y(),e.color),t._bar.hitTestPoint(e.x,e.y)){var h=new s.Particle(e.x,e.y,e.color);h.xSpeed=10*Math.random(),h.ySpeed=9*Math.random()+1,t._balls.push(h),i.push(e)}else e.y>t._height&&i.push(e)})),i.forEach((function(e){var i=t._fallBlocks.indexOf(e);-1!=i&&t._fallBlocks.splice(i,1)})),this._canvas.render()}0==this._blocks.count()?this._handleWin():0==this._balls.length?this._handleLose():window.requestAnimationFrame(this._update.bind(this)),this._canvas.renderBar(this._bar)}},t.prototype._touchmove=function(t){this._bar.x=t.touches[0].clientX-this._canvas.offsetLeft()-this._bar.width/2,this._bar.x+this._bar.width>this._width&&(this._bar.x=this._width-this._bar.width),this._bar.x<0&&(this._bar.x=0),t.preventDefault()},t.prototype._mousemove=function(t){this._bar.x=t.clientX-this._canvas.offsetLeft()-this._bar.width/2,this._bar.x+this._bar.width>this._width&&(this._bar.x=this._width-this._bar.width),this._bar.x<0&&(this._bar.x=0)},t.prototype.init=function(){this._blocks=new s.Blocks(this._width,200),this._fallBlocks=new Array;var t=this._height-10-2;this._bar=new s.Bar(0,t,200,10);var e=new s.Particle(this._width/2,this._height/2,h.DEFAULT_COLOR);e.xSpeed=10*Math.random(),e.ySpeed=9*Math.random()-1,this._balls=new Array,this._balls.push(e),this._fpsInterval=1e3/this._fps,this._then=Date.now(),window.requestAnimationFrame(this._update.bind(this))},t}();e.default=n},409:(t,e)=>{e.__esModule=!0,e.getRainbowColors=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR={red:255,green:255,blue:255};var i=function(t,i,s){if(t<0||t>360||i<0||i>1||s<0||s>1)throw"Incorrect HSV values [HSVToRGB]";var h=t/60,n=s*i,a=n*(1-Math.abs(h%2-1));return h>=0&&h<1?{red:255*n,green:255*a,blue:0}:h>=1&&h<2?{red:255*a,green:255*n,blue:0}:h>=2&&h<3?{red:0,green:255*n,blue:255*a}:h>=3&&h<4?{red:0,green:255*a,blue:255*n}:h>=4&&h<5?{red:255*a,green:0,blue:255*n}:h>=5&&h<6?{red:255*n,green:0,blue:255*a}:e.DEFAULT_COLOR};e.getRainbowColors=function(t){for(var e=[],s=0;s<t;s++){var h=i(360*s/t,1,1);e.push(h)}return e}}},i={};t=function t(s){var h=i[s];if(void 0!==h)return h.exports;var n=i[s]={exports:{}};return e[s](n,n.exports,t),n.exports}(989),window.addEventListener("load",(function(e){var i=document.getElementById("canvas"),s=document.getElementById("container"),h=window.innerWidth>700?700:window.innerWidth,n=window.innerWidth>700?600:.85*window.innerHeight;i.width=h,i.height=n,new t.default(s,i,h,n).init()}))})();